---
layout: post
title:  "Mobius 함수의 정의와 활용"
date:   2019-03-31 21:38:49
author: nyan101
categories: TIL
tags:	[전산, 수학]
use_math: true
---

얼마 전 코드포스에서 [흥미로운 문제](http://codeforces.com/contest/1139/problem/D)를 접했다. 대회 당시에는 풀지 못했는데, 에디토리얼을 읽어보던 중 뫼비우스 함수(Mobius function)에 대한 언급이 있어 이에 대해 좀더 자세히 알아보았다.

### Mobius function의 정의
뫼비우스 함수(Mobius function)는 자연수 n에 대해 다음과 같이 정의된다. (\\(p\\)는 소수) \\

$$
\mu(n) = \begin{cases}
		(-1)^k	&	\mathrm{if\,\,\,\,} n=p_1p_2\cdots p_k \, (p_i \neq p_j)\\
		0		&	\mathrm{if\,\,\,\,} p^2 | n
		\end{cases}
$$

다시 말해, n이 서로 다른 k개 소수들의 곱이면 \\(\\mu(n)\\)은 \\( (-1)^k \\)이, 중복 소인수가 있으면(=어떤 제곱수를 약수로 가지면) 0이 되는 함수라고 할 수 있다. (이때 \\(\\mu(1)=1\\))

뫼비우스 함수의 정의를 살펴보면 두 자연수 a,b에 대해 다음 성질이 성립함을 쉽게 알 수 있다.\\

$$
\mu(ab) = \mu(a)\mu(b) \,\,\,\,\mathrm{if\,}\gcd(a,b)=1
$$

이밖에도 다양한 성질들이 있지만 여기서는 알고리즘적 측면에서의 활용에 집중하기로 한다.

### 포함-배제의 원리

다음 벤 다이어그램을 살펴보자.

<img src="/assets/images/2019/03/mobius-set-diagram.png" width="800px">

전체 합집합의 넓이는 어떻게 구할 수 있을까? 색칠을 해보면 다음 식을 어렵지 않게 구할 수 있다.
$$
\begin{array}{cl}
|A \cup B| & = &|A| + |B| - |A \cap B|\\
|A \cup B \cup C| & = &|A| + |B| + |C| - |A \cap B| - |B \cap C| - |C \cap A| + |A \cap B \cap C|
\end{array}
$$
같은 원리를 확장하면 n개 집합에 대해 다음을 얻을 수 있다.
$$
\begin{aligned}\\{\biggl |}\bigcup _{{i=1}}^{n}A_{i}{\biggr |}&{}=\sum _{{i=1}}^{n}\left|A_{i}\right|-\sum _{{i,j\,:\,1\leq i<j\leq n}}\left|A_{i}\cap A_{j}\right|\\&{}\qquad +\sum _{{i,j,k\,:\,1\leq i<j<k\leq n}}\left|A_{i}\cap A_{j}\cap A_{k}\right|-\ \cdots \ +\left(-1\right)^{{n-1}}\left|A_{1}\cap \cdots \cap A_{n}\right|\end{aligned}
$$
이를 포함-배제의 원리라고 한다. 

### 약수 관계에서의 포함-배제의 원리

이제 이를 약수-배수 관계에서 생각해보자. 자연수 n이 주어졌을 때 \\(S\_n\\)이 정의되고, m이 n의 배수일 때 \\(S\_m \subset S\_n\\) 이 성립한다고 하자. 이러한 성질을 가지는 예로는 \\(S\_n\\)을 **(max 이하의 자연수들 중) \\(n^2\\)의 배수들의 집합**[^1]을 들 수 있다. 그렇다면 모든 자연수 n에 대해 \\(\|\\big\cup \_{{i=2}}^{n}S\_{i}\|\\) 를 구하려면 어떻게 해야 할까?




[^1]: 단순히 "n의 배수들의 집합"이라고 할 수도 있지만, 그 경우 \\(\\big\cup \_{{i=2}}^{n}S\_{i}\\)이 지나치게 단순해지므로 약간 복잡한 정의를 선정.